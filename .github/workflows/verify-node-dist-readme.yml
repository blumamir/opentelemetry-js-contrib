name: Verify Node Distribution README

on:
  pull_request:
    paths:
      - 'metapackages/auto-instrumentations-node/**'

jobs:
  verify-node-dist-readme:
    runs-on: ubuntu-latest
    steps:
    - name: Check out code
      uses: actions/checkout@v4

    - uses: actions/setup-node@v4
      with:
        node-version: 18

    - name: Install dependencies
      run: npm ci

    - name: Verify READMEs
      run: npm run distnode:update-readme
    
    - name: Verify Clean
      run: |
        if [[ $(git diff --exit-code) ]]; then
          git diff
          echo "need to update README.md for @opentelemetry/auto-instrumentations-node. please run 'npm run distnode:update-readme' and commit the changes."
          exit 1
        fi      
